@page
@model WindowPainter.Pages.BrushModel
@{
    ViewBag.Title = "Brush";
}
<script>
(() => {
    window.opener.onbeforeunload = () => window.close();
    var posX, posY;
    var color = "black";
    document.documentElement.style.background = color;
    document.documentElement.addEventListener("click", () => {
        if (color === "black")
            color = "red";
        else color = "black";
        document.documentElement.style.background = color;
        paint();
    }, false);

    function paint() {
        window.opener.paint(posX, posY, outerWidth, outerHeight, color);
    }

    function checkPos() {
        if (posX !== screenX || posY !== screenY) {
            posX = screenX;
            posY = screenY;
            paint();
        }
        window.requestAnimationFrame(checkPos);
    }
    window.requestAnimationFrame(checkPos);
})();
</script>